(this.webpackJsonpjamming=this.webpackJsonpjamming||[]).push([[0],{17:function(e,t,a){e.exports=a(49)},22:function(e,t,a){},23:function(e,t,a){},24:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(16),s=a.n(r),l=(a(22),a(23),a(1)),o=a(6),i=a(3),u=Object(n.createContext)(),p={term:"",accessToken:"",searchResults:[],playlistName:"",playlistTracks:[],userInfo:{}},m=function(e,t){switch(t.type){case"UPDATE_TERM":return Object(i.a)({},e,{term:t.payload});case"UPDATE_PLAYLIST_NAME":return Object(i.a)({},e,{playlistName:t.payload});case"ADD_PLAYLIST_TRACK":return Object(i.a)({},e,{playlistTracks:[].concat(Object(o.a)(e.playlistTracks),[t.payload])});case"REMOVE_PLAYLIST_TRACK":return Object(i.a)({},e,{playlistTracks:Object(o.a)(e.playlistTracks).filter((function(e){return e.id!==t.payload}))});case"RESET_PLAYLIST":return Object(i.a)({},e,{term:"",searchResults:[],playlistName:"",playlistTracks:[]});case"ACCESS_TOKEN":return Object(i.a)({},e,{accessToken:t.payload});case"USER_INFO":return Object(i.a)({},e,{userInfo:t.payload});case"SEARCH_RESULTS":return Object(i.a)({},e,{searchResults:t.payload});default:throw new Error}},f=function(e){var t=e.children,a=Object(n.useReducer)(m,p),r=Object(l.a)(a,2),s=r[0],o=r[1];return c.a.createElement(u.Provider,{value:[s,o]},t)},d=(a(24),a(5)),h=a.n(d),E=a(4),y=a.n(E),T={search:function(e,t){return fetch("https://api.spotify.com/v1/search?type=track&q=".concat(e),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).then((function(e){return e.tracks?e.tracks.items.map((function(e){return{id:e.id,name:e.name,artist:e.artists[0].name,album:e.album.name,uri:e.uri}})):[]})).catch((function(e){return console.log(e)}))},savePlaylist:function(e,t,a,n){var c,r,s,l;return h.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e&&t.length){o.next=3;break}return console.log("need valid playlist input"),o.abrupt("return");case 3:return c=t.map((function(e){return e.uri})),r={Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},o.next=7,h.a.awrap(y()({method:"post",headers:r,url:"https://api.spotify.com/v1/users/".concat(n,"/playlists"),dataType:"json",data:{name:e}}).then((function(e){return e.data.id})));case 7:return s=o.sent,o.next=10,h.a.awrap(y()({method:"post",headers:r,url:"https://api.spotify.com/v1/playlists/".concat(s,"/tracks"),dataType:"json",data:{uris:c}}));case 10:return l=o.sent,o.abrupt("return",l);case 12:case"end":return o.stop()}}))}},b=function(e){var t=e.accessToken,a=Object(n.useContext)(u),r=Object(l.a)(a,2),s=r[0],o=r[1];return Object(n.useEffect)((function(){o({type:"ACCESS_TOKEN",payload:t})}),[t,o]),Object(n.useEffect)((function(){fetch("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(s.accessToken)}}).then((function(e){return e.json()})).then((function(e){o({type:"USER_INFO",payload:e})})).catch((function(e){console.log(e)}))}),[s.accessToken,o]),c.a.createElement("div",{className:"SearchBar"},c.a.createElement("input",{value:s.term,placeholder:"Enter A Song, Album, or Artist",onChange:function(e){o({type:"UPDATE_TERM",payload:e.target.value})},name:"term"}),c.a.createElement("button",{className:"SearchButton",onClick:function(){T.search(s.term,t).then((function(e){o({type:"SEARCH_RESULTS",payload:e})})).catch((function(e){console.log(e)}))}},"SEARCH"))},v=function(e){var t=Object(n.useState)(),a=Object(l.a)(t,2),c=a[0],r=a[1],s=Object(n.useState)(),o=Object(l.a)(s,2),i=o[0],u=o[1],p=Object(n.useState)(),m=Object(l.a)(p,2),f=m[0],d=m[1];return Object(n.useEffect)((function(){y.a.post("/login",{code:e}).then((function(e){r(e.data.accessToken),u(e.data.refreshToken),d(e.data.expiresIn),window.history.pushState({},null,"/")})).catch((function(e){window.location="/"}))}),[e]),Object(n.useEffect)((function(){if(i&&f){var e=setInterval((function(){y.a.post("/refresh",{refreshToken:i}).then((function(e){r(e.data.accessToken),d(e.data.expiresIn)})).catch((function(){window.location="/"}))}),1e3*(f-60));return function(){return clearInterval(e)}}}),[i,f]),c},k=(a(44),a(45),a(46),function(e){var t=e.track,a=e.isRemoval,r=Object(n.useContext)(u),s=Object(l.a)(r,2),o=s[0],i=s[1],p=Object(n.useRef)(!1);return Object(n.useEffect)((function(){o.playlistTracks.find((function(e){return e.id===t.id}))&&(p.current=!0)}),[o.playlistTracks,t.id]),c.a.createElement("div",{className:"Track"},c.a.createElement("div",{className:"Track-information"},c.a.createElement("h3",null,t.name),c.a.createElement("p",null,t.artist," | ",t.album)),a?c.a.createElement("button",{className:"Track-action",onClick:function(){i({type:"REMOVE_PLAYLIST_TRACK",payload:t.id})}},"-"):c.a.createElement("button",{className:"Track-action",onClick:function(){p.current?console.log("already in playlist"):i({type:"ADD_PLAYLIST_TRACK",payload:t})}},"+"))}),O=function(e){var t=e.tracks,a=e.isRemoval;return c.a.createElement("div",{className:"TrackList"},t.map((function(e){return c.a.createElement(k,{track:e,key:e.id,isRemoval:a})})))},j=function(){var e=Object(n.useContext)(u),t=Object(l.a)(e,1)[0];return t.searchResults.length>0?c.a.createElement("div",{className:"SearchResults"},c.a.createElement("h2",null,"Results"),c.a.createElement(O,{tracks:t.searchResults,isRemoval:!1})):null},A=(a(47),function(){var e=Object(n.useContext)(u),t=Object(l.a)(e,2),a=t[0],r=t[1];return a.playlistTracks.length>0?c.a.createElement("div",{className:"Playlist"},c.a.createElement("input",{onChange:function(e){r({type:"UPDATE_PLAYLIST_NAME",payload:e.target.value})},value:a.playlistName,name:"playlistName",placeholder:"Playlist Name"}),c.a.createElement(O,{tracks:a.playlistTracks,isRemoval:!0}),c.a.createElement("button",{className:"pill-button playlist-pill",onClick:function(){T.savePlaylist(a.playlistName,a.playlistTracks,a.accessToken,a.userInfo.id).then((function(e){if(console.log(e),201!==e.status)throw new Error(e.status);r({type:"RESET_PLAYLIST"})})).catch((function(e){console.log(e)}))}},"SAVE TO SPOTIFY")):null}),S=function(e){var t=e.code,a=v(t);return c.a.createElement(f,null,c.a.createElement(b,{accessToken:a}),c.a.createElement("div",{className:"App-playlist"},c.a.createElement(j,null),c.a.createElement(A,null)))};var R=function(){var e="f03925ce76e844a79a88dbbe1f677103",t="https://spotify-playlist-make-cc.herokuapp.com/",a="https://accounts.spotify.com/authorize?client_id=".concat(e,"&response_type=code&redirect_uri=").concat(t,"&scope=playlist-modify-public&show_dialog=true");return console.log({clientId:e,redirectURI:t}),c.a.createElement("div",{className:"login-div"},c.a.createElement("button",{className:"pill-button login-pill"},c.a.createElement("a",{href:a},"Login")))},N=function(){var e=new URLSearchParams(window.location.search).get("code");return e?c.a.createElement(S,{code:e}):c.a.createElement(R,null)},g=(a(48),function(){return c.a.createElement("div",{className:"header-div"},c.a.createElement("h1",null,"Ja",c.a.createElement("span",{className:"highlight"},"mmm"),"ing"))});s.a.render(c.a.createElement("div",{className:"App"},c.a.createElement(g,null),c.a.createElement(N,null)),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.a663af43.chunk.js.map